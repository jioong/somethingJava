# 通用程序设计 #

## 将局部变量的作用域最小化 ##
  
将局部变量的作用域最小化，可以增强代码的可读性和可维护性，并降低出错的可能性。   
**Java 允许在任何可以出现语句的地方声明变量。**    
  
1. 要使局部变量的作用域最小化，最有利的方法就是在第一次使用它的地方声明变量。  
过早的声明局部变量不仅会使它的作用域过早的扩展，而且结束的也过于晚。局部变量的作用域从它被声明的点开始，一直到外围块的结束处。如果变量是在“使用它的块”之外被声明的，当程序退出该块之后，该变量仍是可见的。如果变量在它的目标使用区域之前或者之后意外的被使用的话，将会导致灾难性的后果。  
2. 几乎每个局部变量的声明都应该包含一个初始化表达式。  】
如果还没有足够的信息来对一个变量进行有意义的初始化，就应该推迟这个声明，之道可以初始化为止。  
3. 是方法小而集中。  
如果把两个操作 *activity* 合并到一个方法中，与其中一个操作相关的局部变量就有可能出现在执行另一个操作的代码范围之内。为了防止这种情况发生，只要把这个方法分成两个，每个方法各执行一个操作。  
  
## for-each 循环优先于传统的 for 循环 ##
  
*Java 1.5* 发行版本中引入了 *for-each* 循环，通过完全隐藏迭代器和索引变量，避免了混乱和出错的可能。这种模式同样适用于集合和数组：  
```Java  
	for(Element e : elements){
		doSomething(e);
	}
```  
  
当见到冒号 *：* 时，可以把它读作 “在...” 里面。注意， *for-each* 循环不会有性能损失，甚至用于数组也一样。实际上，在某些情况下，比起普通的 *for* 循环，它还稍微有些优势，因为它对数组索引的边界值只计算一次。   
在对多个集合进行嵌套式迭代时， *for-each* 循环相对于传统 *for* 循环的这种优势就会更加明显。  
*for-each* 循环不仅可以遍历集合和数组，还可以遍历任何实现 *Iterable* 接口的对象。   
  
应该尽可能地使用 *for-each* 循环。遗憾的是，有三种情况无法使用 *for-each* 循环：  
1. 过滤 --- 如果需要遍历集合，并删除选定的元素，就需要显示使用迭代器，以便可以调用它的 *remove()* 方法。  
2. 转换 --- 如果需要遍历列表或数组，并取代它部分或者全部的元素值，就需要列表迭代器或者数组索引，以便设定元素的值。  
3. 平行迭代 --- 如果需要并行地遍历多个集合，就需要显示地控制迭代器或者索引变量，以便所有迭代器或索引变量都可以得到同步前移。  
  
## 如果需要精确的答案，请避免使用 float 和 double ##
  
*float , double* 主要是为了科学计算和工程计算而设计的。它们执行二进制浮点运算 (*binary floating-point arithmetic*) ，这是为了在广泛的数值范围上提供较为精确的快速近似计算而设计的。然而，它们并没有提供完全精确的结果。  
**float, double 类型尤其不适合用于货币计算。**             

  
## 当心字符创连接的性能 ##
  
字符串连接操作符 *+ String concatenation operator* 是把多个字符串合并为一个字符串的便利途径。  
> 为连接 n 个字符串而重复使用字符串连接操作符，需要 n 的平方级的时间。  
  
这是由于字符串的不可变而导致的结果。当两个字符串被连接在一起的时候，它们的内容都要被拷贝。  
为了获得可以接受的性能，使用 *StringBuilder* 代替 *String* 来存储字符串。 *Java 1.5* 中增加了非同步 *StringBuilder* 类代替已经过时的 *StringBuffer* 类。  
  
**总结**：  
* 不要使用字符串连接操作符来合并多个字符串，除非性能无关紧要。  
* 使用 *StringBuilder* 类的 *append()* 方法。  
  


**来源于：[Joshua Bloch 《Effective Java 中文版》](http://www.amazon.cn/Sun-%25E5%2585%25AC%25E5%258F%25B8%25E6%25A0%25B8%25E5%25BF%2583%25E6%258A%2580%25E6%259C%25AF%25E4%25B8%259B%25E4%25B9%25A6-Effective-Java%25E4%25B8%25AD%25E6%2596%2587%25E7%2589%2588-Joshua-Bloch/dp/B001PTGR52?SubscriptionId=AKIAJMGEVRIO53UGJCYQ&tag=16-28-282__-23&linkCode=sp1&camp=2025&creative=165953&creativeASIN=B001PTGR52 "Effective Java 中文版")**    