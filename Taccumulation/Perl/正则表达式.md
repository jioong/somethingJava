2014/12/11 星期四 20:14:33 

# 正则表达式 #

## 何谓正则表达式(regular expression) ##
正则表达式在Perl里通常被称为模式(pattern)，是一个“匹配”或“不匹配”特定字符串的模版。  

模式可能只匹配一个字符串，或是两个、三个甚至无限多个。不然，它也可能匹配所有的字符串，只排除一个、两个或无限多个。

## 元字符(metacharacter) ##

1. 点号(.) 是通配符(wildcard character)，它会匹配换行符(\n)以外的所有**单个**字符。
2. 在任何元字符前面加上反斜线，就会使它失去元字符的特殊作用。

## 量词(quantifier) ##

量词意思是说，它指定了前一个项目的数量。

1. 星号(*) 会匹配它的前一个项目0次或多次。
2. 加号(+) 一次或以上。
3. 问号(?) 0次或一次。

三个量词都必须接在某个东西之后。

## 模式组 ##

圆括号也是元字符。  
用圆括号来规组。

## 择一匹配 ##

竖线(|)念为“或”，表示左边匹配或是右边匹配。

## 字符集(character class) ##

字符集就是方括号里一连串可能出现的字符。**只会匹配单一字符**，但是该字符可以是字符集里的任何一个。  
可以用连字符(-)来指定某个范围的字符。**字符集以外的连字符不具有特殊意义。**  
在字符集的开头加上**插入记号(^)**用来排除字符集。 

## 字符集简写 ##

1. \d 代表任意数字的字符集 [0-9]。
2. \w 代表字母、数字、下划线，字符集[A-Za-z0-9_]。  
3. \s 代表空白符，字符集[\f\t\n\r ]。换页、制表、换行、回车、空格
1. \D 非数字的字符。
2. \W 非单词的字符。  
3. \S 非空白的字符。



# 以正则表达式进行匹配 #

## 以 m// 进行匹配 ##

1. 可以使用两个一对的界定符号  

        m(fred),m<fred>,m{fred},m[fred]

2. 使用单一界定符  

    m，fred，   m!fred!   m^fred^

使用 m//时，可以省略之前的 m 。

## 选项修饰符(option modifier letter) ##

也称为标记(flag)。它们可以整组附加在某个正则表达式结尾的界定符的右边，以改变正则表达式的默认行为。

1. /i  指定不区分大小写的模式匹配。
2. /s  指定点号(.)可以匹配任意字符，包括换行符。
3. /x  指定模式里可以随意加上空白，目的是使得看起来更容易阅读。
4. **组合选项修饰符，可以用到两个以上的选项修饰符。彼此的先后顺序不会影响匹配的结果。**

## 锚点(anchor) ##

可以加入锚点，让模式直接匹配字符串的某处。
1. 插入记号(^)  表示字符串的**开头**。  
2. 美元符号($)  表示字符串的**结尾**。  
3. **单词锚点\b**, 匹配一个单词的头尾两端。  （整字匹配）
4. \B   “非单词边界锚点”，匹配任何不匹配\b的位置。

## 绑定操作符 =~ (binding operator)##

匹配$_只是默认的方式而已。
绑定操作符告诉Perl拿右边的模式来匹配左边的字符串，而非匹配$_。


## 模式内的内插 ##

正则表达式可以进行双引号形式的内插。

## 匹配变量(match variable) ##

**圆括号启动了正则表达式处理引擎的记忆功能。**  

**记忆功能：**指的是把圆括号里的模式所**实际**匹配到的部分字符串暂时记下来的功能。如果有一对以上的圆括号，就会有一份以上的记忆。**每一份记忆所存储的是原本的字符串，而不是模式。**  
匹配变量所存储的是字符串，所以它们都是标量变量。在Perl里，它们的命名方式像$1 或 $2。模式里的括号有多少对，匹配变量就有多少个。  
$1 等变量引用的是模式已近完全匹配之后的结果。

## 记忆的持久性 ##

“匹配变量”的内容通常会维持到下一次模式匹配成功时。也就是说，失败的匹配会保留前次的记忆内容，而成功的匹配会将它们重设。  
“匹配变量”只应该在匹配成功时使用。  

## 自动匹配变量 ## 

1. $&  字符串里实际匹配模式的部分会被自动存放在该变量里。
2. $`  相符段落的前置字符串。保存正则表达式引擎在找到相符段落之前所略过的部分。
3. $'  相符段落的后置字符串。保存了字符串中剩下的、从来没匹配到的部分。

**如果将上面3个字符串依次连接起来，就一定会得到原来的字符串。** 

代价：一旦在程序的任何部分使用了某个自动匹配变量，其他正则表达式的运行速度会变慢。

## 通用量词 ##

模式中的量词代表前置项目的重现次数。

1. 模式/a{5,15}/  匹配重复出现5到15次的字母a。
2. 模式/a{5,}/    匹配至少5个， 即5 到无限多。省略上限次数，保留逗号。
3. 模式/a{5}/     匹配固定次数，同时省略逗号与上限次数。

## 优先级 ##

优先级表(precedence chart)  
1. 最高等级是括号(),用于划分组以及存储。括号里任何东西的紧密度都高于其他字符。  
2. 第二等级是量词，也就是反复操作符(repeat operator)。  
3. 第三等级是锚点(anchor)和序列(sequence)。锚点包括：字符串的起始锚点^、字符串结尾锚点$、单词边界锚点\b以及非单词边界锚点\B。序列（**彼此相邻的项目**）事实上也是操作符。也就是说，**单词里的字母之间和锚点与字母之间的紧密程度是相同的。** 
4. 最低一级是分割用的竖线(|)，它实际上会将模式拆成数个部分